# installation de debian sur la nouvelle machine
# Installation de debian-6.0.2.1-i386-netinst.iso (squeeze)
# Il est possible d'automatiser l'installation à l'aide d'un fichier
# de reponse automatique
# Au démarrage du CD, il faut appuyer sur la touche échap, puis à l'invite boot
auto interface=eth0 mirror/http/proxy=http://10.5.10.13:3128/ url=fgarel.ovh.org

# quelques remarques concernant les différents paramètres employés :
# interface=eth0     : la machine virtualbox est configurée avec deux cartes réseaux
#                      la première est en mode bridge (accès par pont)
#                      la seconde est en mode nat
#                      il faut configuré les deux pour avoir accès à la fois
#                      au réseau interne et à internet
# mirror/http/proxy  : un serveur proxy est installé et configuré sur la
#                      machine hote pour que la machine invitée puisse communiquer
#                      avec l'exterieur malgré le firewall
# url=fgarel.ovh.org : un fichier preseed.cfg est disponible à cet emplacement

# installation de ssh pour pouvoir communiquer entre la machine et l'exterieur
##########################################
echo y | aptitude install ssh 1> /dev/null
##########################################

# sur une machine "amie", montage d'un repertoire contenant
# des scripts et des fichiers de configurations
# (montage de la clef usb)

# sur la nouvelle machine, récupération d'un premier script (via ssh)
###########################################################################
scp root@10.5.10.23:/media/clefUsb/usr/sbin/fg-get-apt-by-ssh.sh /usr/sbin/
###########################################################################

# puis on peut executer ce premier script
# qui aura pour effet de récupérer le reste des fichiers
# qui sont sur la clef usb
####################
fg-get-apt-by-ssh.sh
####################

# on peut alors competer ce script en enchainant plusieurs actions

#   - fgaptitudeclean.sh         : Post-installation : nettoyage et ...
#   - fgaptitudeupdate.sh        : aptitude update "améliorée"
#   - fgaptitudeinstallsys.sh    : Post-installation : ... règlages divers (système)
#   - fgaptitudeinstallvim.sh    : installation de vim
#   - fgaptitudeupgrade.sh       : aptitude upgrade
#   - fgaptitudeinstallpython.sh : installation de python
#   - sudo -u garel fgaptitudeinstallpython.sh
#   - fgaptitudeinstallwebserver.sh
#   - fgaptitudeinstallwebclient.sh
#   - fgaptitudeinstallpostgresql.sh


###############################################################################
echo y | aptitude install ssh 1> /dev/null ; \
scp root@10.5.10.23:/media/clefUsb/usr/sbin/fg-get-apt-by-ssh.sh /usr/sbin/ ; \
fg-get-apt-by-ssh.sh
###############################################################################
